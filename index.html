<!DOCTYPE html>
<html>
<head>
    <title>Xolos Army DEX</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1a1a1a;
            color: #fff;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #333;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        header {
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            color: #ff6666;
        }

        h2 {
            color: #ff3333;
            border-bottom: 2px solid #ff3333;
            padding-bottom: 10px;
            margin-top: 30px;
        }

        .exchange-form, .liquidity-form {
            margin-bottom: 20px;
        }

        .exchange-form input, .liquidity-form input {
            width: calc(50% - 10px);
            padding: 10px;
            margin-right: 10px;
            border: 1px solid #555;
            border-radius: 4px;
            background-color: #444;
            color: #fff;
        }

        .exchange-form button, .liquidity-form button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            background-color: #ff6666;
            color: #fff;
            cursor: pointer;
        }

        #transactions {
            list-style-type: none;
            padding: 0;
        }

        #transactions li {
            margin-bottom: 10px;
        }

        #transactions a {
            color: #ff6666;
            text-decoration: none;
            transition: color 0.3s;
        }

        #transactions a:hover {
            color: #ff9999;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.6.0/dist/web3.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Xolos Army DEX</h1>
            <p>A decentralized exchange for Xolos $RMZ Token</p>
        </header>
        <main>
            <div id="walletInfo">
                <h2>Wallet Information</h2>
                <p>Address: <span id="walletAddress">Not connected</span></p>
                <p>Balance: <span id="walletBalance">0</span> BCH</p>
                <button onclick="connectWallet()">Connect Wallet</button>
            </div>
            <h2>Exchange BCH for Xolos $RMZ</h2>
            <div class="exchange-form">
                <input type="number" id="bchAmount" placeholder="BCH amount">
                <input type="number" id="minTokens" placeholder="Minimum tokens to receive">
                <button onclick="swapBCHForToken()">Exchange</button>
            </div>
            <h2>Exchange Xolos $RMZ for BCH</h2>
            <div class="exchange-form">
                <input type="number" id="tokenAmount" placeholder="Xolos $RMZ amount">
                <input type="number" id="minBCH" placeholder="Minimum BCH to receive">
                <button onclick="swapTokenForBCH()">Exchange</button>
            </div>
            <div id="status"></div>
            <div id="transactionHistory">
                <h2>Transaction History</h2>
                <ul id="transactions"></ul>
            </div>

            <h2>Add Liquidity</h2>
            <div class="liquidity-form">
                <input type="number" id="liquidityBchAmount" placeholder="BCH amount">
                <input type="number" id="liquidityRmzAmount" placeholder="Xolos $RMZ amount">
                <button onclick="addLiquidity()">Add Liquidity</button>
            </div>
            <h2>Remove Liquidity</h2>
            <div class="liquidity-form">
                <input type="number" id="removeLiquidityAmount" placeholder="Liquidity amount to remove">
                <button onclick="removeLiquidity()">Remove Liquidity</button>
            </div>
            <div id="liquidityStatus"></div>
        </main>
    </div>
    <script>
        const tokenAddress = '0x49F9ECF126B6dDF51C731614755508A4674bA7eD';
        const liquidityPoolAddress = '0x948134045c356Ba9C72E8cB4C9f4aA93d68506C7';
        const explorerBaseUrl = 'https://smartscout.cash/tx/';
        let wallet = null;
        let web3;
        let liquidityPoolContract;

        const liquidityPoolABI = [
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "tokenAmount",
                        "type": "uint256"
                    }
                ],
                "name": "addLiquidity",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "_token",
                        "type": "address"
                    }
                ],
                "stateMutability": "nonpayable",
                "type": "constructor"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "provider",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amountBCH",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amountToken",
                        "type": "uint256"
                    }
                ],
                "name": "LiquidityAdded",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "provider",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amountBCH",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amountToken",
                        "type": "uint256"
                    }
                ],
                "name": "LiquidityRemoved",
                "type": "event"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "removeLiquidity",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "minTokens",
                        "type": "uint256"
                    }
                ],
                "name": "swapBCHForToken",
                "outputs": [],
                "stateMutability": "payable",
                "type": "function"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "swapper",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amountIn",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "amountOut",
                        "type": "uint256"
                    },
                    {
                        "indexed": false,
                        "internalType": "bool",
                        "name": "isBCHToToken",
                        "type": "bool"
                    }
                ],
                "name": "Swapped",
                "type": "event"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "tokenAmount",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "minBCH",
                        "type": "uint256"
                    }
                ],
                "name": "swapTokenForBCH",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "balanceOf",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            }
        ];

        async function connectWallet() {
            if (window.ethereum) {
                web3 = new Web3(window.ethereum);
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    wallet = accounts[0];
                    document.getElementById('walletAddress').innerText = wallet;
                    updateBalance();
                } catch (error) {
                    console.error("User denied account access", error);
                }
            } else {
                alert("Please install MetaMask!");
            }
        }

        async function updateBalance() {
            const balance = await web3.eth.getBalance(wallet);
            document.getElementById('walletBalance').innerText = web3.utils.fromWei(balance, 'ether');
        }

        async function swapBCHForToken() {
            const bchAmount = document.getElementById('bchAmount').value;
            const minTokens = document.getElementById('minTokens').value;
            const contract = new web3.eth.Contract(liquidityPoolABI, liquidityPoolAddress);

            try {
                await contract.methods.swapBCHForToken(minTokens).send({ from: wallet, value: web3.utils.toWei(bchAmount, 'ether') });
                document.getElementById('status').innerText = 'Swap successful!';
                addTransaction('BCH to RMZ');
            } catch (error) {
                console.error("Swap failed", error);
                document.getElementById('status').innerText = 'Swap failed!';
            }
        }

        async function swapTokenForBCH() {
            const tokenAmount = document.getElementById('tokenAmount').value;
            const minBCH = document.getElementById('minBCH').value;
            const contract = new web3.eth.Contract(liquidityPoolABI, liquidityPoolAddress);

            try {
                await contract.methods.swapTokenForBCH(tokenAmount, minBCH).send({ from: wallet });
                document.getElementById('status').innerText = 'Swap successful!';
                addTransaction('RMZ to BCH');
            } catch (error) {
                console.error("Swap failed", error);
                document.getElementById('status').innerText = 'Swap failed!';
            }
        }

        async function addLiquidity() {
            const bchAmount = document.getElementById('liquidityBchAmount').value;
            const rmzAmount = document.getElementById('liquidityRmzAmount').value;
            const contract = new web3.eth.Contract(liquidityPoolABI, liquidityPoolAddress);

            try {
                await contract.methods.addLiquidity(rmzAmount).send({ from: wallet, value: web3.utils.toWei(bchAmount, 'ether') });
                document.getElementById('liquidityStatus').innerText = 'Liquidity added!';
                addTransaction('Add Liquidity');
            } catch (error) {
                console.error("Add liquidity failed", error);
                document.getElementById('liquidityStatus').innerText = 'Add liquidity failed!';
            }
        }

        async function removeLiquidity() {
            const liquidityAmount = document.getElementById('removeLiquidityAmount').value;
            const contract = new web3.eth.Contract(liquidityPoolABI, liquidityPoolAddress);

            try {
                await contract.methods.removeLiquidity(liquidityAmount).send({ from: wallet });
                document.getElementById('liquidityStatus').innerText = 'Liquidity removed!';
                addTransaction('Remove Liquidity');
            } catch (error) {
                console.error("Remove liquidity failed", error);
                document.getElementById('liquidityStatus').innerText = 'Remove liquidity failed!';
            }
        }

        function addTransaction(type) {
            const transactionsList = document.getElementById('transactions');
            const newTransaction = document.createElement('li');
            newTransaction.innerHTML = `<a href="${explorerBaseUrl}" target="_blank">${type}</a>`;
            transactionsList.appendChild(newTransaction);
        }
    </script>
</body>
</html>